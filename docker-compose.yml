version: '2'

services:

  php:
    build: ./lamp/php/
    env_file:
    - ./lamp.env
    volumes:
    - ./:/var/www/html:rw
    links:
    - mysql
    restart: "no"

  php56:
    build: ./lamp/php56/
    extends:
      service: php
    ports:
    - "8056:80"
    - "44356:443"

  php70:
    build: ./lamp/php56/
    extends:
      service: php
    ports:
    - "8070:80"
    - "44370:443"

  php71:
    build: ./lamp/php56/
    extends:
      service: php
    ports:
    - "8071:80"
    - "44371:443"

  php72:
    build: ./lamp/php56/
    extends:
      service: php
    ports:
    - "8072:80"
    - "44372:443"

  mysql:
    image: mysql:5.5
    environment:
    - MYSQL_ROOT_PASSWORD=root
    - MYSQL_DATABASE=database
    - MYSQL_USER=user
    - MYSQL_PASSWORD=user
    ports:
    - "33060:3306"
    restart: "no"

  adminer:
    build:
      context: ./lamp/adminer/
      dockerfile: Dockerfile-adminer
    environment:
    - ADMINER_SERVER=mysql
    - ADMINER_USER=root
    - ADMINER_PASSWORD=root
    - ADMINER_DATABASE=database
    ports:
    - "30303:8080"
    links:
    - mysql
    restart: "no"
